{% extends 'base.html' %}

{% block title %}KI-Analyse für {{ group.name }}{% endblock %}

{% block content %}
    <h2 class="text-3xl font-bold text-gray-800 mb-2">KI-Analyse für Gruppe: {{ group.name }}</h2>
    <p class="text-gray-600 mb-6">Wählen Sie die Teilnehmer aus, für die ein Bericht generiert werden soll.</p>

    <form action="{{ url_for('configure_batch_ai_analysis') }}" method="post">
        <div class="bg-white border border-gray-200 rounded-lg shadow p-6">
            
            <div class="flex items-center p-3 border-b border-gray-200">
                <input id="select-all" type="checkbox" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                <label for="select-all" class="ms-2 text-sm font-bold text-gray-900">Alle auswählen / abwählen</label>
            </div>

            <div class="space-y-2 mt-4">
            {% for p in participants %}
                <div class="flex items-center p-3 rounded hover:bg-gray-50">
                    <input id="p-{{ p.id }}" name="participant_ids" value="{{ p.id }}" type="checkbox" class="participant-checkbox w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500">
                    <label for="p-{{ p.id }}" class="ms-2 text-sm font-medium text-gray-900">{{ p.name }}</label>
                </div>
            {% else %}
                <p class="text-gray-500 italic p-3">Für diese Gruppe gibt es keine Teilnehmer.</p>
            {% endfor %}
            </div>
        </div>

        <div class="mt-8">
            <button type="submit" class="w-full md:w-auto py-3 px-8 rounded-md text-white bg-green-600 hover:bg-green-700 font-semibold text-lg">
                <i class="fas fa-brain me-2"></i>Analyse für ausgewählte Teilnehmer starten
            </button>
        </div>
    </form>

    <script>
        const selectAllCheckbox = document.getElementById('select-all');
        const participantCheckboxes = document.querySelectorAll('.participant-checkbox');

        selectAllCheckbox.addEventListener('change', (e) => {
            participantCheckboxes.forEach(checkbox => {
                checkbox.checked = e.target.checked;
            });
        });
    </script>
{% endblock %}